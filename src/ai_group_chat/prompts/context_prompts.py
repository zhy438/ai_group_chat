"""ä¸Šä¸‹æ–‡å‹ç¼©ä¸åˆ†ç±»ç›¸å…³æç¤ºè¯æ¨¡æ¿ã€‚"""

from __future__ import annotations


CLASSIFY_SYSTEM_PROMPT = """ä½ æ˜¯ä¸€ä¸ªæ¶ˆæ¯åˆ†ç±»ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯å¯¹å¯¹è¯æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ï¼Œç”¨äºä¸Šä¸‹æ–‡å‹ç¼©å†³ç­–ã€‚

æ¶ˆæ¯ç±»å‹å®šä¹‰ï¼š
- user: ç”¨æˆ·å‘é€çš„æ¶ˆæ¯ï¼ˆæœ€é‡è¦ï¼Œå¿…é¡»ä¿ç•™ï¼‰
- status: å…³é”®çŠ¶æ€æ¶ˆæ¯ï¼ˆä»»åŠ¡å®Œæˆã€å†³ç­–ç¡®å®šã€æœ€ç»ˆç»“è®ºç­‰é‡Œç¨‹ç¢‘èŠ‚ç‚¹ï¼‰
- reasoning: æ¨ç†è¿‡ç¨‹æ¶ˆæ¯ï¼ˆæ€è€ƒåˆ†æã€æ–¹æ¡ˆæ¯”è¾ƒã€æƒè¡¡è®¨è®ºç­‰ä¸­é—´è¿‡ç¨‹ï¼‰
- failure: å¤±è´¥è®°å½•æ¶ˆæ¯ï¼ˆé”™è¯¯æŠ¥å‘Šã€å¤±è´¥åŸå› ã€é—®é¢˜è¯Šæ–­ç­‰éœ€è¦è®°ä½çš„æ•™è®­ï¼‰
- normal: æ™®é€šæ¶ˆæ¯ï¼ˆæœªæ˜ç¡®å±äºä»¥ä¸Šç±»å‹çš„ä¸€èˆ¬å¯¹è¯ï¼‰

åˆ†ç±»ä¾æ®ï¼š
1. userç±»å‹ï¼šæ¶ˆæ¯æ¥è‡ª"ç”¨æˆ·"æˆ–"User"
2. statusç±»å‹ï¼šåŒ…å«"å®Œæˆ"ã€"æˆåŠŸ"ã€"ç¡®å®š"ã€"ç»“è®º"ã€"æœ€ç»ˆ"ç­‰ç¡®å®šæ€§è¯æ±‡
3. reasoningç±»å‹ï¼šåŒ…å«"è€ƒè™‘"ã€"åˆ†æ"ã€"å¯èƒ½"ã€"å¦‚æœ"ã€"æ–¹æ¡ˆ"ç­‰æ¨ç†è¯æ±‡
4. failureç±»å‹ï¼šåŒ…å«"å¤±è´¥"ã€"é”™è¯¯"ã€"é—®é¢˜"ã€"æ— æ³•"ã€"bug"ç­‰å¤±è´¥è¯æ±‡
5. normalç±»å‹ï¼šä¸æ˜ç¡®å±äºä»¥ä¸Šç±»å‹çš„æ¶ˆæ¯

è¯·ä¸¥æ ¼æŒ‰ç…§JSONæ ¼å¼è¾“å‡ºï¼Œä¸è¦æœ‰å…¶ä»–å†…å®¹ã€‚"""


CLASSIFY_USER_PROMPT_TEMPLATE = """è¯·å¯¹ä»¥ä¸‹æ¶ˆæ¯è¿›è¡Œåˆ†ç±»ã€‚

æ¶ˆæ¯åˆ—è¡¨ï¼š
{messages}

è¯·è¿”å›JSONæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€æ¡æ¶ˆæ¯çš„åˆ†ç±»ç»“æœï¼š
[{{"index": 0, "type": "ç±»å‹"}}, {{"index": 1, "type": "ç±»å‹"}}, ...]

æ³¨æ„ï¼štype åªèƒ½æ˜¯ user/status/reasoning/failure/normal ä¹‹ä¸€ã€‚"""


SUMMARIZE_SYSTEM_PROMPT = """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ‘˜è¦ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†ä¸€æ®µå¯¹è¯å†å²å‹ç¼©æˆç®€æ´çš„ç»“æ„åŒ–æ‘˜è¦ã€‚

è¦æ±‚ï¼š
1. ä¿ç•™å…³é”®ä¿¡æ¯ï¼šç”¨æˆ·çš„æ ¸å¿ƒé—®é¢˜ã€é‡è¦å†³ç­–ã€ä»»åŠ¡çŠ¶æ€
2. åˆ é™¤å†—ä½™ï¼šç§»é™¤é‡å¤çš„è®¨è®ºè¿‡ç¨‹ã€æ— å…³çš„é—²èŠ
3. ä¿æŒç»“æ„ï¼šä½¿ç”¨æ¸…æ™°çš„åˆ†ç‚¹æ ¼å¼
4. æ§åˆ¶é•¿åº¦ï¼šæ‘˜è¦é•¿åº¦ä¸è¶…è¿‡åŸæ–‡çš„ 30%

è¾“å‡ºæ ¼å¼ï¼š
ğŸ“‹ å¯¹è¯æ‘˜è¦
- æ ¸å¿ƒè¯é¢˜ï¼š...
- å…³é”®ç»“è®ºï¼š...
- å¾…åŠäº‹é¡¹ï¼š...ï¼ˆå¦‚æœ‰ï¼‰
"""


SUMMARIZE_USER_PROMPT_TEMPLATE = """è¯·å¯¹ä»¥ä¸‹å¯¹è¯å†å²è¿›è¡Œæ‘˜è¦ï¼š

{conversation}

è¯·ç”Ÿæˆç®€æ´çš„ç»“æ„åŒ–æ‘˜è¦ï¼š"""


def build_classify_user_prompt(messages_text: str) -> str:
    """æ„å»ºæ¶ˆæ¯åˆ†ç±»ç”¨æˆ·æç¤ºè¯ã€‚"""
    return CLASSIFY_USER_PROMPT_TEMPLATE.format(messages=messages_text)


def build_summarize_user_prompt(conversation_text: str) -> str:
    """æ„å»ºæ‘˜è¦ç”¨æˆ·æç¤ºè¯ã€‚"""
    return SUMMARIZE_USER_PROMPT_TEMPLATE.format(conversation=conversation_text)
